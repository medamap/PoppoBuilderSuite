# PoppoBuilder Suite 高度な要求定義

## 作成日: 2025/6/15
## ステータス: 要求収集中

## 1. マルチプロジェクト対応とキューイング

### 要求
- 複数のプロジェクトが異なる場所で動作する
- システム常駐プロセスは1本で統一管理
- Claude Code最大2本の制限下でのキューイング
- プロジェクト間でのタスク優先順位管理

### 想定される構成
```
/usr/local/poppo-builder/     # システム全体の設定
├── daemon/                   # 常駐プロセス
├── queue/                    # グローバルキュー
└── projects.json            # 登録プロジェクト一覧

~/project-a/
└── .poppo/                  # プロジェクト固有設定

~/project-b/
└── .poppo/                  # プロジェクト固有設定
```

## 2. 要求トレーサビリティ機能

### 要求
- 要求定義と要件定義の対応関係を明確化
- 各フェーズ間のリンク情報管理
- 未対応項目の可視化

### トレーサビリティマトリックス例
```
要求定義ID | 要件定義ID | 概要設計ID | 詳細設計ID | 実装ID | テストID
REQ-001   | SPEC-001   | HLD-001    | DLD-001    | IMP-001 | TEST-001
REQ-002   | SPEC-002   | HLD-002    | (未実装)    | -       | -
REQ-003   | (未定義)    | -          | -          | -       | -
```

### リンク情報の管理
```yaml
requirements:
  REQ-001:
    title: "テストファースト開発"
    status: "implemented"
    links:
      specifications: ["SPEC-001"]
      designs: ["HLD-001", "DLD-001"]
      implementations: ["IMP-001"]
      tests: ["TEST-001"]
```

## 3. 整合性監査機能

### 要求
- 要求定義・要件定義・設計・実装の整合性チェック
- カバレッジ分析（どの要求が実装されているか）
- 削除時の影響分析
- 不整合の自動検出とレポート

### 監査項目
1. **カバレッジ監査**
   - すべての要求定義に対応する要件定義があるか
   - すべての要件定義が設計されているか
   - すべての設計が実装されているか
   - すべての実装がテストされているか

2. **整合性監査**
   - 要求と実装の乖離チェック
   - 未使用の設計・実装の検出
   - 循環参照の検出

3. **削除影響分析**
   - 要求削除時の影響範囲表示
   - 依存関係グラフの生成
   - 安全な削除の確認プロセス

### 監査レポート例
```markdown
## 整合性監査レポート

### サマリー
- 要求定義: 12件
- 実装済み: 8件 (66.7%)
- 設計のみ: 2件 (16.7%)
- 未着手: 2件 (16.7%)

### 問題点
1. REQ-003: 要件定義が未作成
2. SPEC-005: 対応する要求定義が不明
3. IMP-007: テストが未作成

### 推奨アクション
- REQ-003の要件定義を作成
- SPEC-005の要求定義を確認または作成
- IMP-007のテストケースを作成
```

## 4. PoppoBuilder設定の階層管理

### 要求
- システムレベル設定（全プロジェクト共通）
- プロジェクトレベル設定（個別カスタマイズ）
- 設定の継承と上書き

### 設定階層
```
1. システムデフォルト設定
2. ユーザーグローバル設定 (~/.poppo/config)
3. プロジェクト設定 (project/.poppo/config)
4. 環境変数による上書き
```

## 5. 実装の優先順位

### Phase 1（現在）
- 単一プロジェクト、単一プロセス
- 基本的なIssue処理

### Phase 2（次期）
- トレーサビリティ機能の基礎
- 要求定義IDの自動採番
- 簡易的なリンク管理

### Phase 3（将来）
- マルチプロジェクト対応
- 常駐デーモン化
- 高度な監査機能

## 注意事項
- これらは高度な機能のため、基本機能が安定してから実装
- 過度に複雑にならないよう段階的に機能追加
- ユーザビリティを常に考慮